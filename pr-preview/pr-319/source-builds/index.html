<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content="venvstacks Package Source Builds - venvstacks Documentation" name="og:title" />
<meta content="website" name="og:type" />
<meta content="https://venvstacks.lmstudio.ai/source-builds/" name="og:url" />
<meta content="venvstacks Package Source Builds - venvstacks Documentation" name="og:description" />
<link rel="search" title="Search" href="../search/"><link rel="next" title="Design Discussion" href="../design/"><link rel="prev" title="Environment Stack File Formats" href="../file-formats/">
        <link rel="canonical" href="https://venvstacks.lmstudio.ai/source-builds/">

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>Building Packages from Source - venvstacks documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../"><div class="brand">venvstacks documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../">
  
  <span class="sidebar-brand-text">venvstacks documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search/" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/">Project Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary/">Essential Terms and Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../file-formats/">Environment Stack File Formats</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Building Packages from Source</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/">Design Discussion</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/">Python API</a><input aria-label="Toggle navigation of Python API" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/cli/">venvstacks.cli</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/pack_venv/">venvstacks.pack_venv</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/stacks/">venvstacks.stacks</a><input aria-label="Toggle navigation of venvstacks.stacks" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.StackSpec/">venvstacks.stacks.StackSpec</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.BuildEnvironment/">venvstacks.stacks.BuildEnvironment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.LayerCategories/">venvstacks.stacks.LayerCategories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.LayerCategory/">venvstacks.stacks.LayerCategory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.LayerSpecMetadata/">venvstacks.stacks.LayerSpecMetadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.LayerVariant/">venvstacks.stacks.LayerVariant</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.LayerVariants/">venvstacks.stacks.LayerVariants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.TargetPlatform/">venvstacks.stacks.TargetPlatform</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.TargetPlatforms/">venvstacks.stacks.TargetPlatforms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.ArchiveBuildMetadata/">venvstacks.stacks.ArchiveBuildMetadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.ArchiveBuildRequest/">venvstacks.stacks.ArchiveBuildRequest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.ArchiveHashes/">venvstacks.stacks.ArchiveHashes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.ArchiveMetadata/">venvstacks.stacks.ArchiveMetadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.PublishedArchivePaths/">venvstacks.stacks.PublishedArchivePaths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.StackPublishingRequest/">venvstacks.stacks.StackPublishingRequest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.StackPublishingResult/">venvstacks.stacks.StackPublishingResult</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.LayerExportRequest/">venvstacks.stacks.LayerExportRequest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.ExportMetadata/">venvstacks.stacks.ExportMetadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.ExportedEnvironmentPaths/">venvstacks.stacks.ExportedEnvironmentPaths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.StackExportRequest/">venvstacks.stacks.StackExportRequest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.LayerSpecBase/">venvstacks.stacks.LayerSpecBase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.RuntimeSpec/">venvstacks.stacks.RuntimeSpec</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.LayeredSpecBase/">venvstacks.stacks.LayeredSpecBase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.FrameworkSpec/">venvstacks.stacks.FrameworkSpec</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.ApplicationSpec/">venvstacks.stacks.ApplicationSpec</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.LayerEnvBase/">venvstacks.stacks.LayerEnvBase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.RuntimeEnv/">venvstacks.stacks.RuntimeEnv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.LayeredEnvBase/">venvstacks.stacks.LayeredEnvBase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.FrameworkEnv/">venvstacks.stacks.FrameworkEnv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.ApplicationEnv/">venvstacks.stacks.ApplicationEnv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.EnvironmentLock/">venvstacks.stacks.EnvironmentLock</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.EnvironmentLockMetadata/">venvstacks.stacks.EnvironmentLockMetadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.PackageIndexConfig/">venvstacks.stacks.PackageIndexConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.BuildEnvError/">venvstacks.stacks.BuildEnvError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.EnvStackError/">venvstacks.stacks.EnvStackError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/stacks/venvstacks.stacks.LayerSpecError/">venvstacks.stacks.LayerSpecError</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../development/">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog/">Changelog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/lmstudio-ai/venvstacks/blob/main/docs/source-builds.rst?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/lmstudio-ai/venvstacks/edit/main/docs/source-builds.rst" rel="edit" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="building-packages-from-source">
<h1>Building Packages from Source<a class="headerlink" href="#building-packages-from-source" title="Link to this heading">¶</a></h1>
<section id="reproducible-builds">
<h2>Reproducible Builds<a class="headerlink" href="#reproducible-builds" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">venvstacks</span></code> is designed around ensuring that the layer archives that it
produces are <a class="reference external" href="https://reproducible-builds.org/">reproducible</a>: if the same
stack definition is built again later with the same
<a class="reference external" href="https://reproducible-builds.org/docs/perimeter/">build environment</a>,
then the resulting layer archives will be byte-for-byte identical with
those produced by the original stack build.</p>
<p>One of the ways this is achieved is by requiring that all Python packages
included in a stack build be provided as pre-built
<a class="reference external" href="https://packaging.python.org/en/latest/specifications/binary-distribution-format/">binary wheels</a>.
This allows the layer lock files to record the exact binary hashes of their
expected inputs, while the deterministic installation process for binary wheels
avoids introducing variation into the layer archive output (avoiding the
potentially build location dependent aspects of wheel installation is the reason
some package features, such as direct execution scripts, are not available in
the layer environments created by <code class="docutils literal notranslate"><span class="pre">venvstacks</span></code>).</p>
<p>While <code class="docutils literal notranslate"><span class="pre">venvstacks</span></code> does not natively support building components from source
references, some users may not wish to use publicly available binary artifacts,
or may depend on projects that don’t provide such artifacts. This section
provides some suggestions and recommendations for handling these situations.</p>
</section>
<section id="building-artifacts-from-source">
<h2>Building artifacts from source<a class="headerlink" href="#building-artifacts-from-source" title="Link to this heading">¶</a></h2>
<p>The first task is determining which artifacts need to be built and then
actually building them.</p>
<section id="systematic-builds-of-entire-dependency-trees">
<h3>Systematic builds of entire dependency trees<a class="headerlink" href="#systematic-builds-of-entire-dependency-trees" title="Link to this heading">¶</a></h3>
<p>The <a class="reference external" href="https://github.com/python-wheel-build/fromager">Fromager</a> project
is designed specifically for this task. Quoting the project’s goals,
Fromager is designed to guarantee that:</p>
<ul class="simple">
<li><p>Every binary package you install was built from source in a reproducible
environment compatible with your own.</p></li>
<li><p>All dependencies are also built from source, no prebuilt binaries.</p></li>
<li><p>The build tools themselves are built from source, ensuring a fully transparent toolchain.</p></li>
<li><p>Builds can be customized for your needs:
applying patches, adjusting compiler options, or producing build variants.</p></li>
</ul>
<p>That last point includes ensuring that built components with external dynamic
library dependencies are linked against the desired versions of those libraries.</p>
<p>Note that building complex stacks with Fromager may require passing <code class="docutils literal notranslate"><span class="pre">--skip-constraints</span></code>,
as <code class="docutils literal notranslate"><span class="pre">venvstacks</span></code> intentionally allows layers that don’t depend on each other
to specify conflicting package version constraints.</p>
</section>
<section id="selective-builds-of-required-packages">
<h3>Selective builds of required packages<a class="headerlink" href="#selective-builds-of-required-packages" title="Link to this heading">¶</a></h3>
<p>If appropriately configured, Fromager can technically support this approach as
well. However, providing details of such a configuration is use case dependent
and hence beyond the scope of these build suggestions.</p>
<p>More commonly, the components that require building are found by repeatedly
running venvstacks and recording the list of projects that the locking failures
indicate do not have binary wheels available for installation.</p>
<p>Once that list of projects is available, a use case dependent mechanism can
then be used to coordinate downloading the source artifacts and producing
appropriately built wheels for the platforms of interest (essentially
undertaking an ad hoc approach to the problem that Fromager approaches
systematically).</p>
</section>
</section>
<section id="including-private-artifacts-in-layer-builds">
<h2>Including private artifacts in layer builds<a class="headerlink" href="#including-private-artifacts-in-layer-builds" title="Link to this heading">¶</a></h2>
<p>Once the binary wheels are available, the second task is then to actually
include those wheels into the layer locking and building process.</p>
<section id="private-index-servers">
<h3>Private index servers<a class="headerlink" href="#private-index-servers" title="Link to this heading">¶</a></h3>
<p>The primary recommended approach is to run the stack builds against a private
index server such as a self-hosted <a class="reference external" href="https://doc.devpi.net/">depvi</a> instance,
or a cloud-hosted repository service such as
JFrog’s <a class="reference external" href="https://jfrog.com/help/r/jfrog-artifactory-documentation/pypi-repositories">Artifactory</a>
or Astral’s <a class="reference external" href="https://astral.sh/pyx">pyx</a>.</p>
<p>These can be set up to serve as both a caching proxy for publicly available packages
<em>and</em> a host for privately built packages, allowing the stack builds to be
appropriately configured with a single <code class="docutils literal notranslate"><span class="pre">tool.uv.index</span></code> entry in the stack
definition file:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[[tool.uv.index]]</span>
<span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;https://internal.example.com/pyindex/&quot;</span>
<span class="n">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</pre></div>
</div>
<p>More complex arrangements using the
<a class="reference internal" href="../file-formats/#package-indexes"><span class="std std-ref">package_indexes</span></a> and
<a class="reference internal" href="../file-formats/#priority-indexes"><span class="std std-ref">priority_indexes</span></a> layer specification settings are
also possible. The
<a class="reference external" href="https://github.com/lmstudio-ai/venvstacks/tree/main/examples">published examples</a>
demonstrate such configurations using the public PyTorch repositories,
as those are the kinds of parallel build scenarios where the simple caching
proxy override approach may be insufficient.</p>
</section>
<section id="local-wheel-directories">
<h3>Local wheel directories<a class="headerlink" href="#local-wheel-directories" title="Link to this heading">¶</a></h3>
<p>Prior to the addition of index server configuration support, the only provided
mechanism for including additional wheels in the layer locking and building
process was to pass the <code class="docutils literal notranslate"><span class="pre">--local-wheels</span></code> option to the <code class="docutils literal notranslate"><span class="pre">venvstacks</span></code> CLI.</p>
<p>This mechanism is still supported, with no plans to remove it, but there may
be some situations where <code class="docutils literal notranslate"><span class="pre">uv</span></code> will be unable to lock a stack defined this way,
while being able to successfully lock a stack that uses an appropriate index
server configuration instead.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../design/">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Design Discussion</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../file-formats/">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Environment Stack File Formats</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Element Labs Inc.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Building Packages from Source</a><ul>
<li><a class="reference internal" href="#reproducible-builds">Reproducible Builds</a></li>
<li><a class="reference internal" href="#building-artifacts-from-source">Building artifacts from source</a><ul>
<li><a class="reference internal" href="#systematic-builds-of-entire-dependency-trees">Systematic builds of entire dependency trees</a></li>
<li><a class="reference internal" href="#selective-builds-of-required-packages">Selective builds of required packages</a></li>
</ul>
</li>
<li><a class="reference internal" href="#including-private-artifacts-in-layer-builds">Including private artifacts in layer builds</a><ul>
<li><a class="reference internal" href="#private-index-servers">Private index servers</a></li>
<li><a class="reference internal" href="#local-wheel-directories">Local wheel directories</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=adf8fbb0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>